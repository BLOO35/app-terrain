<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Terrain</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: Arial; padding: 20px; background: #f5f5f5; margin: 0; }
        .container { max-width: 500px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        h1 { text-align: center; color: #667eea; margin: 0 0 20px 0; }
        .page { display: none; }
        .page.active { display: block; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; font-size: 16px; border: 1px solid #ddd; border-radius: 5px; }
        button { width: 100%; padding: 16px; margin: 10px 0; font-size: 16px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-primary { background: #667eea; color: white; }
        .btn-secondary { background: #ddd; }
        .btn-success { background: #4caf50; color: white; }
        .btn-danger { background: #ff6b6b; color: white; }
        .btn-row { display: flex; gap: 10px; margin: 20px 0; }
        .btn-row button { flex: 1; margin: 0; }
        .entry { background: #f0f0f0; padding: 12px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #667eea; }
        .counter { text-align: center; font-size: 18px; font-weight: bold; color: #667eea; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“‹ App Terrain</h1>
        
        <div id="page0" class="page active">
            <h2 style="text-align: center;">Zone</h2>
            <button class="btn-primary" onclick="goZone()">Louvroil</button>
        </div>
        
        <div id="page1" class="page">
            <h2>Infos</h2>
            <input type="text" id="nom" placeholder="Nom">
            <input type="text" id="prenom" placeholder="PrÃ©nom">
            <input type="text" id="semaine" placeholder="Semaine">
            <input type="text" id="client" placeholder="Client">
            <input type="text" id="magasin" placeholder="Magasin">
            <div class="btn-row">
                <button class="btn-secondary" onclick="goPage(0)">Retour</button>
                <button class="btn-primary" onclick="check1()">Suivant</button>
            </div>
        </div>
        
        <div id="page2" class="page">
            <h2>Adresse</h2>
            <select id="commune" onchange="loadRues()"><option value="">Commune</option></select>
            <select id="rue"><option value="">Rue</option></select>
            <input type="number" id="numero" placeholder="NÂ°">
            <select id="habitat"><option value="">Habitat</option><option value="Pavillon">Pavillon</option><option value="Immeuble">Immeuble</option></select>
            <input type="number" id="foyers" placeholder="Foyers">
            <select id="acces"><option value="">AccÃ¨s</option><option value="Libre">Libre</option><option value="Cle">ClÃ©</option><option value="Vigik">Vigik</option></select>
            <select id="resultat"><option value="">RÃ©sultat</option><option value="Servi">Servi</option><option value="Non">Non servi</option><option value="Mal">Mal servi</option></select>
            <input type="text" id="resident" placeholder="RÃ©sident">
            <div class="btn-row">
                <button class="btn-secondary" onclick="goPage(1)">Retour</button>
                <button class="btn-success" onclick="save()">Valider</button>
            </div>
        </div>
        
        <div id="page3" class="page">
            <h2>Adresses</h2>
            <div class="counter" id="counter">0 adresses</div>
            <div id="entries"></div>
            <button class="btn-primary" onclick="goPage(2)">+ Nouvelle</button>
            <button class="btn-danger" onclick="end()">Fin</button>
        </div>
    </div>

    <script>
        var entries = [];
        var page1Data = {};
        var communes = ["FERRIERE LA GRANDE", "HAUTMONT", "LOUVROIL", "MAUBEUGE"];
        var rues = {
            "FERRIERE LA GRANDE": ["ALLEE DES OEILLETS", "AVENUE DU MARECHAL FOCH", "RUE DE BEAUFORT", "RUE VICTOR HUGO"],
            "HAUTMONT": ["ALLEE D HALVER", "AVENUE D HEBBURN", "PLACE DE LA LIBERATION", "RUE DES LILAS"],
            "LOUVROIL": ["AVENUE DE MONTFORT", "ROUTE D AVESNES", "RUE ALBERT CALMETTE", "RUE JEAN JAURES"],
            "MAUBEUGE": ["AVENUE DE FERRIERE", "ROUTE D AVESNES", "RUE DE LOUVROIL", "RUE DU CHEMIN VERT"]
        };

        function goPage(n) {
            var pages = document.querySelectorAll('.page');
            for (var i = 0; i < pages.length; i++) {
                pages[i].classList.remove('active');
            }
            document.getElementById('page' + n).classList.add('active');
        }

        function goZone() {
            loadCommunes();
            goPage(1);
        }

        function loadCommunes() {
            var select = document.getElementById('commune');
            select.innerHTML = '<option value="">Commune</option>';
            for (var i = 0; i < communes.length; i++) {
                var opt = document.createElement('option');
                opt.value = communes[i];
                opt.textContent = communes[i];
                select.appendChild(opt);
            }
        }

        function loadRues() {
            var commune = document.getElementById('commune').value;
            var select = document.getElementById('rue');
            select.innerHTML = '<option value="">Rue</option>';
            
            if (commune && rues[commune]) {
                for (var i = 0; i < rues[commune].length; i++) {
                    var opt = document.createElement('option');
                    opt.value = rues[commune][i];
                    opt.textContent = rues[commune][i];
                    select.appendChild(opt);
                }
            }
        }

        function check1() {
            var nom = document.getElementById('nom').value.trim();
            var prenom = document.getElementById('prenom').value.trim();
            var semaine = document.getElementById('semaine').value.trim();
            var client = document.getElementById('client').value.trim();
            var magasin = document.getElementById('magasin').value.trim();
            
            if (!nom || !prenom || !semaine || !client || !magasin) {
                alert('Remplissez tous les champs');
                return;
            }
            
            page1Data = {nom: nom, prenom: prenom, semaine: semaine, client: client, magasin: magasin};
            goPage(2);
        }

        function save() {
            var commune = document.getElementById('commune').value.trim();
            var rue = document.getElementById('rue').value.trim();
            var numero = document.getElementById('numero').value.trim();
            var habitat = document.getElementById('habitat').value.trim();
            var foyers = document.getElementById('foyers').value.trim();
            var acces = document.getElementById('acces').value.trim();
            var resultat = document.getElementById('resultat').value.trim();
            var resident = document.getElementById('resident').value.trim();
            
            if (!commune || !rue || !numero || !habitat || !foyers || !acces || !resultat) {
                alert('Remplissez tous les champs');
                return;
            }
            
            var entry = {
                numero: entries.length + 1,
                commune: commune,
                rue: rue,
                numero_rue: numero,
                habitat: habitat,
                foyers: foyers,
                acces: acces,
                resultat: resultat,
                resident: resident,
                nom: page1Data.nom,
                prenom: page1Data.prenom
            };
            
            entries.push(entry);
            display();
            reset();
            goPage(3);
        }

        function reset() {
            document.getElementById('commune').value = '';
            document.getElementById('rue').innerHTML = '<option value="">Rue</option>';
            document.getElementById('numero').value = '';
            document.getElementById('habitat').value = '';
            document.getElementById('foyers').value = '';
            document.getElementById('acces').value = '';
            document.getElementById('resultat').value = '';
            document.getElementById('resident').value = '';
        }

        function display() {
            var html = '';
            for (var i = 0; i < entries.length; i++) {
                var e = entries[i];
                html += '<div class="entry"><strong>#' + e.numero + ' - ' + e.numero_rue + ' ' + e.rue + '</strong><br>' + e.commune + ' | ' + e.habitat + ' | ' + e.resultat + '</div>';
            }
            document.getElementById('entries').innerHTML = html;
            document.getElementById('counter').textContent = entries.length + ' adresse(s)';
        }

        function end() {
            if (entries.length === 0) {
                alert('Aucune adresse !');
                return;
            }
            
            if (confirm('Envoyer ' + entries.length + ' adresses ?')) {
                alert('âœ… ' + entries.length + ' adresses envoyÃ©es !');
                entries = [];
                document.getElementById('entries').innerHTML = '';
                document.getElementById('counter').textContent = '0 adresses';
                goPage(0);
            }
        }
    </script>
</body>
</html>
